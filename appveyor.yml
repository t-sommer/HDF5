image:
  - Visual Studio 2015

build: false

install:
  # download the HDF5 sources
  - appveyor DownloadFile https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.10/hdf5-1.10.1/src/hdf5-1.10.1.zip
  
  # extract the archive
  - 7z x hdf5-1.10.1.zip

  # configure and generate the Visual Studio solution
  - cd hdf5-1.10.1
  
  # build x86
  - mkdir msvc2015-x86
  - cd msvc2015-x86
  - cmake ..
  - msbuild hl\src\hdf5_hl-static.vcxproj /t:Clean,Build /p:Configuration=Debug
  - msbuild hl\src\hdf5_hl-static.vcxproj /t:Clean,Build /p:Configuration=Release
  
  # build x64
  - cd ..
  - mkdir msvc2015-x64
  - cd msvc2015-x64
  - cmake ..
  - msbuild hl\src\hdf5_hl-static.vcxproj /t:Clean,Build /p:Configuration=Debug
  - msbuild hl\src\hdf5_hl-static.vcxproj /t:Clean,Build /p:Configuration=Release

  # create the archive
  - cd ..\..
  - 7z a hdf5-1.10.1-msvc2015.zip hdf5-1.10.1\COPYING hdf5-1.10.1\src\*.h hdf5-1.10.1\hl\src\*.h hdf5-1.10.1\msvc2015-*\*.h hdf5-1.10.1\msvc2015-*\bin\*\*.lib hdf5-1.10.1\msvc2015-*\bin\Debug\*.pdb

artifacts:
  - path: hdf5-1.10.1-msvc2015.zip
